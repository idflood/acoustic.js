!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Acoustic=t()}}(function(){return function t(e,i,n){function a(r,s){if(!i[r]){if(!e[r]){var u="function"==typeof require&&require;if(!s&&u)return u(r,!0);if(o)return o(r,!0);var f=new Error("Cannot find module '"+r+"'");throw f.code="MODULE_NOT_FOUND",f}var c=i[r]={exports:{}};e[r][0].call(c.exports,function(t){var i=e[r][1][t];return a(i?i:t)},c,c.exports,t,e,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)a(n[r]);return a}({1:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(e){var i=void 0===arguments[1]?{}:arguments[1];n(this,t),this.options=i,this.fftSize=i.fftSize||512,this.filters=i.filters||this.getDefaultFilters(),this.audio=this.initAudio(e),this.currentTime=0,this.playing=!1,this.context=new(window.AudioContext||window.webkitAudioContext),this.source=this.context.createMediaElementSource(this.audio),this.analyser=this.context.createAnalyser(),this.analyser.fftSize=this.fftSize,this.samples=this.analyser.frequencyBinCount,this.delay=this.context.createDelay?this.context.createDelay():this.context.createDelayNode(),this.delay.delayTime.value=2*this.fftSize/this.context.sampleRate,this.data={timeDomainData:new Uint8Array(this.samples),timeDomainRMS:0,filters:{}},this.source.connect(this.analyser),this.analyser.connect(this.delay),this.delay.connect(this.context.destination),this.filters=this.initFilters(this.filters,this.data)}return t.prototype.initAudio=function(t){var e=this,i=!1;return i="string"==typeof t?new Audio(t):t,i.addEventListener("canplay",function(){e.options.onCanPlay&&e.options.onCanPlay(e)}),i},t.prototype.update=function(){if(this.playing){var t=this;this.analyser.smoothingTimeConstant=!1,this.analyser.getByteTimeDomainData(this.data.timeDomainData),this.data.timeDomainRMS=this.rms(this.data.timeDomainData),Object.keys(this.filters).forEach(function(e){var i=t.filters[e],n=t.data.filters[e];i.analyserNode.fftSize=t.fftSize,i.analyserNode.getByteTimeDomainData(n.timeDomainData),n.timeDomainRMS+=.4*(t.rms(n.timeDomainData)-n.timeDomainRMS)})}},t.prototype.rms=function(t){for(var e=t.length,i=0,n=0;e>n;n++){var a=Math.abs(t[n]-128);i+=a*a}return Math.sqrt(i/e)},t.prototype.play=function(){this.audio&&(this.playing=!0,this.audio.play(),this.audio.currentTime=this.currentTime)},t.prototype.pause=function(){this.audio&&(this.playing=!1,this.audio.pause())},t.prototype.seek=function(t){this.currentTime=t,this.audio&&this.audio.paused===!1&&(this.audio.currentTime=this.currentTime)},t.prototype.getValue=function(t){var e=void 0;return t?void 0!==this.data.filters[t]&&(e=this.data.filters[t].timeDomainRMS):e=this.data.timeDomainRMS,e},t.prototype.initFilters=function(t,e){var i=this;return Object.keys(t).forEach(function(n){var a=t[n];a.biquadFilter=i.context.createBiquadFilter(),a.biquadFilter.type=a.type,a.biquadFilter.frequency.value=a.frequency,a.biquadFilter.Q.value=a.Q,a.analyserNode=i.context.createAnalyser(),a.analyserNode.fftSize=i.fftSize,a.gainNode=i.context.createGain?i.context.createGain():i.context.createGainNode(),a.gainNode.gain.value=a.gain,i.source.connect(a.gainNode),a.gainNode.connect(a.biquadFilter),a.biquadFilter.connect(a.analyserNode),e.filters[n]={timeDomainData:new Uint8Array(i.samples),timeDomainRMS:0}}),t},t.prototype.getDefaultFilters=function(){return{bass:{type:"lowpass",frequency:120,Q:1.2,gain:12},mid:{type:"bandpass",frequency:400,Q:1.2,gain:12},high:{type:"highpass",frequency:2e3,Q:1.2,gain:12}}},t}();e.exports=a},{}]},{},[1])(1)});